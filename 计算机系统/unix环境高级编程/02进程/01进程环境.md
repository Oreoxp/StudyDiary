# 进程环境

[TOC]



## main 函数

​		main函数原型是：
`int main(int argc, char *argv[]);`

argc是命令行参数的数目、argv是指向参数的各个指针所构成的数组。

​		当内核执行 C 程序时(使用 exec 函数)，在调用 main 前先调用一个特殊的启动例程。可执行程序文件将此启动例程指定为程序的起始地址——这是由连接编辑器设置的，而连接编辑器则由 C 编译器调用。启动例程从内核取得命令行参数和环境变量值，然后为按上述方式调用 main 函数做好安排。

## 进程终止

​		有 8 种方式使进程终止(termination), 其中 5 种为正常终止，它们是:

​			(1) 从main返回;
​			(2) 调用exit;
​			(3) 调用_ exit或_ Exit;
​			(4) 最后一个线程从其启动例程返回(11.5节);
​			(5) 从最后一个线程调用pthread exit (11.5节)。

​		异常终止有3种方式，它们是:

​			(6) 调用abort (10.17节);
​			(7) 接到一个信号(10.2节);
​			(8) 最后一个线程对取消请求做出响应(11.5 节和12.7节)。

​		上节提及的启动例程是这样编写的，main函数返回后应该立即调用exit函数，它调用main函数的形式可能是：

`exit(main(argc, argv));`

![C程序时如何启动和终止的](.\markdownimage\C程序时如何启动和终止的.png)

​		**<u>注意：内核使程序执行的唯一方法是调用一个 exec 函数。进程自愿终止的唯一方法是显示或隐式的 ( 如 exit ) 调用 _exit 或 _Exit。</u>**















