



# 渲染管线 Graphics (Real-time Rendering)Pipeline

### 2.1 渲染管线流程

​		通过图形渲染管线都是流水线形式，上一阶段的输出作为下一阶段的输入，该课程的一个图形渲染管线（也是前向渲染管线）流程如下：
![image.png](https://bbs-img.huaweicloud.com/blogs/img/20220506/1651822500227254676.png)

​		总体来说：顶点 →光栅化 →着色
​		用mvp举例：
MVP（Model, View, Projection transforms）→采样 →z-buffer test →shading →Texture mapping
![image.png](https://bbs-img.huaweicloud.com/blogs/img/20220506/1651822511823927146.png)

具体来说：

1. 首先我们有一系列三维点坐标，可能是从某些文件读入。然后我们把它们输入给Vertex Processing阶段（顶点着色器），该阶段主要进行的操作是`model`，`view`，`projection`变换，将三维坐标变换到二维裁剪空间（通过投影丢掉了不可见的区域），也可以进行`gouraud shading`等操作。
   ![image.png](https://bbs-img.huaweicloud.com/blogs/img/20220506/1651824544265916242.png)
2. 随后把顶点着色器的输出，作为输入给`Triangle Processing`阶段，这里主要是进行一些图元的绘制，包括把点连接成三角形，或者制作一些顶点的副本等
3. 下一个阶段是`Rasterization`阶段（光栅化），该阶段将三维图元作为输入，通过采样将其绘制在二维屏幕上，并以`片段`的形式作为输出。

片段、像素 关系说明：

- `片段(Fragment)`:三维顶点光栅化后的数据集合，还没有经过深度测试
- `像素`:片段经过深度测试、模板测试、alpha混合之后的结果
- 片段的个数远远多于像素，因为有的片段会在测试和混合阶段被丢弃，无法被渲染成像素

![image.png](https://bbs-img.huaweicloud.com/blogs/img/20220506/1651824753556261646.png)

1. `Fragment Processing` 把片段作为输入。该阶段主要进行`深度测试`，`计算光照`以及`纹理映射`等，所以该阶段输出的结果基本上已经确定了像素最终的颜色。
   ![image.png](https://bbs-img.huaweicloud.com/blogs/img/20220506/1651824875253313204.png)

![image.png](https://bbs-img.huaweicloud.com/blogs/img/20220506/1651824892223991670.png)

![image.png](https://bbs-img.huaweicloud.com/blogs/img/20220506/1651824902380140045.png)